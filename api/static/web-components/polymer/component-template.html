<link rel="import" href="../static/bower_components/polymer/polymer.html">
<link rel="import" href="../static/bower_components/iron-ajax/iron-ajax.html">
<dom-module id="web-component" id='component'>
    <template>
        <link rel="stylesheet" href="../static/bower_components/bootstrap/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="../static/bower_components/lato-font/css/lato-font.css">
        <link rel="stylesheet" href="../static/web-components/css/component.css">


        <iron-ajax id="ComponentRequest"

                    url="../api/component"
                    method="POST" content-type="application/json"
                    handle-as="json"></iron-ajax>

        <iron-ajax id="AuthRequest"

                    url="../api/component-user-data"
                    method="POST"
                    content-type="application/json"
                    handle-as="json"
                    on-response="_handleAuthRequestResponse"
                    on-error="_handleAuthRequestError"></iron-ajax>

         <iron-ajax id="ChangesRequest"

                    url="../api/component-user-data-update"
                    method="POST"
                    content-type="application/json"
                    handle-as="json"
                    on-response="_handleChangesRequestResponse"
                    on-error="_handleChangesRequestError"></iron-ajax>

        <iron-ajax id="GetDataResponse"

                    method="GET"
                    url="../api/v2/app"
                    handle-as="json"
                    on-response="_handleDataRequest"></iron-ajax>


        <nav class="main-nav hidden" id="web-component-main">
            <ul class="pinned">
                    <template id="elements" is="dom-repeat" items="{{response}}" filter="_pinnedFilter" observe="pinArray">
                        <li>
                            <a target="_blank" href="{{item.link}}">
                                <img src="{{_getProperPath(item.img_link)}}"/>
                            </a>
                        </li>
                    </template>
                </ul>
                <button class="burger-icon c-hidden" id="button-switch" on-tap="_showToggle"><span class="glyphicon glyphicon-th"></span> </button>
                <aside class="component-overflow c-hidden" id="web-component-navbar">
                    <div id="loading-box" class="loading-box"><span class="spinner"></span></div>
                    <div class="user-label">
                            <div class="user-label-list" id="user-label-list">
                                <template is="dom-if" if="{{!checkAccess}}">
                                    <div class="action-button" on-tap="_showEmailInput">
                                        <span class="glyphicon glyphicon-user" ></span>
                                    </div>
                                </template>
                                <template is="dom-if" if="{{checkAccess}}">
                                    <div class="action-button" on-tap="_switchView">
                                        <span class="glyphicon glyphicon-cog"></span>
                                    </div>
                                        <div class="action-button">
                                            <span class="glyphicon glyphicon-log-out" on-tap="_signMeOut"></span>
                                        </div>

                                </template>
                            </div>
                        </div>
                    <ul class="component-ul" id="items_ul">
                        <template is="dom-if" if="{{!checkAccess}}">
                            <input id="tokenValue" type="number" placeholder="Eight Digit Number" name="email" on-keydown="_tokenRequestSend">
                        </template>
                        <template id="elements" is="dom-repeat" items="{{response}}" filter="_hideFilter" sort="_selfSort">
                            <li>
                                <a target="_blank" href="{{item.link }}">
                                    <img crossOrigin="Anonymous" src="{{_getProperPath(item.img_link)}}" on-load='_getColor' />
                                    <span class="text">{{item.name }}</span>
                                    <template is="dom-if" if="{{item.beta}}"><span class="app-beta">Beta</span></template>
                                </a>
                            </li>
                        </template>
                    </ul>
                    <ul class="component-ul hidden" id="sortable_ul" >
                        <span class="user-email"><span class="glyphicon glyphicon-user"></span>{{email}}</span>
                        <template id="orders" is="dom-repeat" items="{{response}}" filter="_voidFilter" sort="_selfSort" observer="pin hide">
                            <li class="order-li noselect" id="{{item.id}}">
                                <div class="option-icon" on-tap="_pinAppTrigger" id="{{item.id}}">
                                    <span class$="glyphicon glyphicon-pushpin val-{{item.pin}}" ></span>
                                </div>
                                <div class="option-icon" on-tap="_hiddenAppTrigger" id="{{item.id}}">
                                    <span class$="glyphicon glyphicon-eye-open val-{{!item.hide}}" ></span>
                                </div>
                                <span class="order-li-name">{{item.name}}</span>
                                <div class="drag-icon"><span class="glyphicon glyphicon-menu-hamburger"></span></div>
                            </li>
                        </template>
                        <button class="button-simple" on-tap="_sortRequestSend">Sort</button>
                    </ul>
                </aside>
        </nav>

    </template>
    <script src="../static/bower_components/color-thief/dist/color-thief.min.js"></script>
    <script src="../static/bower_components/Sortable/Sortable.js"></script>
    <script src="../static/web-components/js/polymer-ui.js"></script>

</dom-module>
